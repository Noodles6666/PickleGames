# ⚫⚪ 五子棋游戏完成报告

## 📋 项目概述

**游戏名称**: 五子棋 (Gomoku)  
**游戏类型**: 双人对战 + 单人练习  
**参照模式**: 台球 (Pool) 的练习模式设计  
**完成日期**: 2026-01-20  
**构建状态**: ✅ 成功

---

## 🎮 游戏特色

### 核心玩法
- ⚫ **黑白对弈**: 黑子先手，白子后手
- 🎯 **胜利条件**: 在棋盘上连成五个同色棋子（横、竖、斜）
- 🤝 **双人对战**: 支持两名玩家实时对战
- 🎓 **单人练习**: 等待对手时可以练习摆棋

### 特色功能
1. **练习模式** (参照台球设计)
   - 单人时自动进入练习模式
   - 可以自由放置黑子和白子
   - 第二名玩家加入后自动切换为对战模式

2. **智能判定**
   - 自动检测五子连珠（四个方向）
   - 自动检测平局（棋盘填满）
   - 实时回合提示

3. **友好界面**
   - 清晰的回合提示
   - 棋子放置音效
   - 精美的胜利/平局消息

---

## 📁 文件结构

### 新增文件
```
decompiled_procyon/me/c7dev/lobbygames/games/
└── Gomoku.java                    # 五子棋游戏主类 (500+ 行)
```

### 修改文件
```
decompiled_procyon/me/c7dev/lobbygames/
├── util/GameType.java             # 添加 GOMOKU 枚举
├── LobbyGames.java                # 注册五子棋游戏
└── gui/AdminGUI.java              # 添加五子棋到 GUI

config_zh_CN.yml                   # 添加五子棋配置
src/main/resources/config_zh_CN.yml # 同上
```

---

## 🎨 GUI 界面

### 创建菜单中的五子棋
- **位置**: Slot 23
- **图标**: 平滑石头 (SMOOTH_STONE)
- **显示名**: §8§l⚫ 五子棋 (Gomoku)
- **描述**:
  - 连成五个同色棋子即可获胜
  - 尺寸要求：最小 9x9，推荐 15x15
  - 玩家数：1-2 人
  - 特色：支持单人练习模式

---

## ⚙️ 配置文件

### config_zh_CN.yml
```yaml
gomoku:
  game-alias: "五子棋"
  wager-cost: 0
  practice-mode-enabled: true
  practice-mode-msg: "&a等待对手时可以练习！"
  exit-practice-mode: "&c退出练习模式"
  black-material: "BLACK_CONCRETE"
  white-material: "WHITE_CONCRETE"
  start-msg: |
    &3&m----------------------------------------
    &b&l五子棋：&b在棋盘上连成五个同色棋子即可获胜！
    &7黑子先手，白子后手
    &3&m----------------------------------------
  player-joined: "&a%player% 加入了游戏！"
  win-msg: |
    &6&m----------------------------------------
    &e&l%winner% &e赢得了五子棋游戏！
    &6&m----------------------------------------
  draw-msg: |
    &2&m----------------------------------------
    &a&l这局游戏平局！
    &2&m----------------------------------------
  reset-on-end: false
```

### 可配置项
- `practice-mode-enabled`: 是否启用练习模式
- `black-material`: 黑子方块材质
- `white-material`: 白子方块材质
- 各种消息文本

---

## 🎯 游戏流程

### 1. 创建竞技场
```
/pg create gomoku
```

**步骤**:
1. 前往棋盘的左下角，输入 `/pg set`
2. 前往棋盘的右上角，输入 `/pg set`
3. 前往出生点（棋盘外），输入 `/pg set`
4. 保存竞技场，输入 `/pg save`

**尺寸要求**:
- 最小：9x9
- 推荐：15x15 或 19x19（标准五子棋尺寸）
- 支持垂直棋盘（墙上）和水平棋盘（地面）

### 2. 单人练习模式
```
/pg join gomoku
```

**练习功能**:
- 获得黑子和白子物品
- 可以自由放置任意颜色的棋子
- 用于熟悉游戏规则和策略
- 第二名玩家加入后自动结束练习

### 3. 双人对战模式

**玩家1**:
```
/pg join gomoku
```
进入练习模式等待对手

**玩家2**:
```
/pg join gomoku
```
加入后游戏自动开始

**对战规则**:
- 黑子先手（随机分配）
- 轮流下棋
- 只能使用自己颜色的棋子
- 不能在已有棋子的位置下棋

### 4. 胜利条件

**五子连珠**:
- 横向连成五个
- 纵向连成五个
- 左斜向连成五个
- 右斜向连成五个

**平局**:
- 棋盘填满且无人获胜

---

## 🔧 技术实现

### 核心类：Gomoku.java

**主要字段**:
```java
private Player p1, p2;              // 两名玩家
private boolean p1_turn;            // 当前回合
private boolean practice;           // 练习模式标志
private boolean game_started;       // 游戏是否开始
private byte[][] board;             // 棋盘状态数组
private int board_size;             // 棋盘大小
private boolean is_vertical;        // 是否垂直棋盘
```

**主要方法**:
- `startGame()`: 初始化游戏
- `placeStone()`: 放置棋子（对战模式）
- `placePracticeStone()`: 放置棋子（练习模式）
- `checkWin()`: 检查胜利条件
- `checkDirection()`: 检查特定方向的连珠
- `isBoardFull()`: 检查平局
- `updateTurnDisplay()`: 更新回合提示

### 胜利判定算法

**四个方向检测**:
```java
// 横向 (1, 0)
// 纵向 (0, 1)
// 左斜 (1, 1)
// 右斜 (1, -1)
```

**计数逻辑**:
1. 从当前位置向两个方向延伸
2. 统计连续同色棋子数量
3. 总数 ≥ 5 则判定获胜

---

## 🎮 物品系统

### 玩家物品栏
- **Slot 0**: 黑子 (BLACK_CONCRETE)
- **Slot 1**: 白子 (WHITE_CONCRETE)
- **Slot 8**: 退出按钮 (ARROW)

### 物品功能
- **黑子/白子**: 右键点击棋盘放置
- **退出按钮**: 退出游戏或练习模式

---

## 🎨 视觉效果

### 棋盘材质
- **底板**: 橡木木板 (OAK_PLANKS)
- **黑子**: 黑色混凝土 (BLACK_CONCRETE)
- **白子**: 白色混凝土 (WHITE_CONCRETE)

### 音效
- **放置棋子**: BLOCK_STONE_PLACE

### 消息颜色
- **回合提示**: §a绿色（你的回合）/ §7灰色（对手回合）
- **胜利消息**: §6金色 + §e黄色
- **平局消息**: §2深绿 + §a浅绿
- **练习提示**: §a绿色

---

## 📊 游戏数据

### 支持的竞技场类型
- ✅ 水平棋盘（地面）
- ✅ 垂直棋盘（墙上）
- ✅ 任意尺寸（最小 9x9）

### 玩家模式
- ✅ 单人练习
- ✅ 双人对战
- ❌ 多人观战（未实现）

### 排行榜
- ✅ 支持全局排行榜
- ✅ 支持本地排行榜
- ✅ 记录胜利次数

---

## 🔄 游戏流程图

```
玩家1加入
    ↓
进入练习模式
    ↓
等待玩家2
    ↓
玩家2加入
    ↓
游戏开始（随机先手）
    ↓
轮流下棋
    ↓
检查胜利/平局
    ↓
游戏结束
    ↓
清空棋盘
```

---

## 🎯 使用示例

### 创建标准 15x15 棋盘
1. 使用 `/pg gui` 打开管理界面
2. 点击"创建新竞技场"
3. 选择"⚫ 五子棋"
4. 在地面选择 15x15 区域
5. 设置出生点
6. 保存竞技场

### 开始游戏
```
玩家A: /pg join gomoku
系统: 进入练习模式，等待对手...

玩家B: /pg join gomoku
系统: 玩家B 加入了游戏！
系统: 你的回合 / 对手的回合
```

---

## 🐛 已知限制

1. **AI 对手**: 目前不支持单人对战 AI
2. **悔棋功能**: 不支持撤销操作
3. **时间限制**: 没有回合时间限制
4. **禁手规则**: 未实现专业五子棋禁手规则

---

## 🚀 未来改进方向

1. **AI 对手**: 添加简单/中等/困难 AI
2. **悔棋功能**: 允许撤销最后一步
3. **时间限制**: 添加回合计时器
4. **禁手规则**: 实现三三禁手、四四禁手等
5. **观战模式**: 允许其他玩家观战
6. **棋谱记录**: 保存对局记录
7. **复盘功能**: 回放历史对局

---

## 📝 命令列表

### 管理员命令
- `/pg create gomoku` - 创建五子棋竞技场
- `/pg delete gomoku <ID>` - 删除竞技场
- `/pg tp gomoku <ID>` - 传送到竞技场
- `/pg clearstands gomoku <ID>` - 清除盔甲架

### 玩家命令
- `/pg join gomoku [ID]` - 加入游戏
- `/pg quit` - 退出游戏
- `/pg list gomoku` - 查看竞技场列表

---

## 🎊 总结

五子棋游戏已完整实现，包含以下特色：

✅ **完整的游戏逻辑** - 五子连珠判定、平局检测  
✅ **练习模式** - 参照台球设计，单人可练习  
✅ **双人对战** - 流畅的回合制对战  
✅ **友好界面** - 清晰的提示和精美的消息  
✅ **灵活配置** - 可自定义材质和消息  
✅ **GUI 集成** - 已添加到管理界面  
✅ **完整汉化** - 所有消息均为中文  

**构建文件**: `target/PickleGames-1.0.jar`  
**游戏数量**: 12 种（新增五子棋）  
**状态**: ✅ 生产就绪

---

**开发时间**: 2026-01-20  
**版本**: PickleGames 1.0  
**游戏编号**: #12
